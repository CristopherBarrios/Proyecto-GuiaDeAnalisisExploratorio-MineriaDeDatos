---
title: "Proyect"
author: 'Cristopher Barrios, Elian, Angel Higueros, Mariana David '
date: "16/2/2023"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

librerias
```{r, echo=FALSE}
library(haven)
library(stats)
library(dplyr)
library(ggplot2)
library(cluster) #Para calcular la silueta
library(e1071)#para cmeans
library(mclust) #mixtures of gaussians
library(fpc) #para hacer el plotcluster
library(NbClust) #Para determinar el número de clusters óptimo
library(factoextra) #Para hacer gráficos bonitos de clustering
library(hopkins) #Para revisar si vale la pena hacer agrupamiento
library(GGally) #Para hacer el conjunto de graficos
library(FeatureImpCluster) #Para revisar la importancia de las variables en los grupos. # nolint
library(pheatmap) #Para hacer mapa de calor
```

datos
```{r}
M2009 <- read_sav("Matrimonios/Matrimonio2009.sav") # nolint
M2010 <- read_sav("Matrimonios/Matrimonio2010.sav") # nolint
M2011 <- read_sav("Matrimonios/Matrimonio2011.sav") # nolint
M2012 <- read_sav("Matrimonios/Matrimonio2012.sav") # nolint
M2013 <- read_sav("Matrimonios/Matrimonio2013.sav") # nolint
M2014 <- read_sav("Matrimonios/Matrimonio2014.sav") # nolint
M2015 <- read_sav("Matrimonios/Matrimonio2015.sav") # nolint
M2016 <- read_sav("Matrimonios/Matrimonio2016.sav") # nolint
M2017 <- read_sav("Matrimonios/Matrimonio2017.sav") # nolint
M2018 <- read_sav("Matrimonios/Matrimonio2018.sav") # nolint
M2019 <- read_sav("Matrimonios/Matrimonio2019.sav") # nolint
M2020 <- read_sav("Matrimonios/Matrimonio2020.sav") # nolint
M2021 <- read_sav("Matrimonios/Matrimonio2021.sav") # nolint
```
Nacimiento
```{r}
N2009 <- read_sav("Nacimientos/Nacimiento2009.sav") # nolint
N2010 <- read_sav("Nacimientos/Nacimiento2010.sav") # nolint
N2011 <- read_sav("Nacimientos/Nacimiento2011.sav") # nolint
N2012 <- read_sav("Nacimientos/Nacimiento2012.sav") # nolint
N2013 <- read_sav("Nacimientos/Nacimiento2013.sav") # nolint
N2014 <- read_sav("Nacimientos/Nacimiento2014.sav") # nolint
N2015 <- read_sav("Nacimientos/Nacimiento2015.sav") # nolint
N2016 <- read_sav("Nacimientos/Nacimiento2016.sav") # nolint
N2017 <- read_sav("Nacimientos/Nacimiento2017.sav") # nolint
N2018 <- read_sav("Nacimientos/Nacimiento2018.sav") # nolint
N2019 <- read_sav("Nacimientos/Nacimiento2019.sav") # nolint
N2020 <- read_sav("Nacimientos/Nacimiento2020.sav") # nolint
N2021 <- read_sav("Nacimientos/Nacimiento2021.sav") # nolint
```
Divorcios
```{r}
D2009 <- read_sav("Divorcios/Divorcio2009.sav") # nolint
D2010 <- read_sav("Divorcios/Divorcio2010.sav") # nolint
D2011 <- read_sav("Divorcios/Divorcio2011.sav") # nolint
D2012 <- read_sav("Divorcios/Divorcio2012.sav") # nolint
D2013 <- read_sav("Divorcios/Divorcio2013.sav") # nolint
D2014 <- read_sav("Divorcios/Divorcio2014.sav") # nolint
D2015 <- read_sav("Divorcios/Divorcio2015.sav") # nolint
D2016 <- read_sav("Divorcios/Divorcio2016.sav") # nolint
D2017 <- read_sav("Divorcios/Divorcio2017.sav") # nolint
D2018 <- read_sav("Divorcios/Divorcio2018.sav") # nolint
D2019 <- read_sav("Divorcios/Divorcio2019.sav") # nolint
D2020 <- read_sav("Divorcios/Divorcio2020.sav") # nolint
D2021 <- read_sav("Divorcios/Divorcio2021.sav") # nolint
```


## Descripción variables y observaciones 
Comience describiendo cuantas variables y observaciones tiene disponibles, el
tipo de cada una de las variables.

```{r}
vars1_numéricas <- sapply(D2009, is.numeric) #Analisis de divorcios 2009 # nolint
vars2_numéricas <- sapply(D2010, is.numeric) #Analisis de divorcios 2010 # nolint
print(vars1_numéricas)
print(vars2_numéricas)
```

## Resumen de datos para verificar si son numéricas 
Haga un resumen de las variables numéricas e investigue si siguen una
distribución normal y tablas de frecuencia para las variables categóricas, escriba lo
que vaya encontrando. 
```{r}
summary(M2009)
```

## Resumen de datos para verificar si son numéricas 
```{r}

```

## Variables importantes
Cruce las variables que considere que son las más importantes para hallar los
elementos clave que lo pueden llevar a comprender lo que está causando el
problema encontrado.
```{r}

```

## Graficos exploratorios 
Haga gráficos exploratorios que le de ideas del estado de los datos.
```{r}

```

## Clustering
Haga un agrupamiento (clustering) e interprete los resultados.
```{r}


```

-----------------------------------------------------------------------------------------
# Analisis

```{r}
  EdadMujD2009 <- sum(D2009$Edadmuj)
  EdadMujD2010 <- sum(D2010$edadmuj)
  EdadMujD2011 <- sum(D2011$edadmuj)
  EdadMujD2012 <- sum(D2012$EDADMUJ)
  EdadMujD2013 <- sum(D2013$EDADMUJ)
  EdadMujD2014 <- sum(D2014$EDADMUJ)
  EdadMujD2015 <- sum(D2015$EDADMUJ)
  EdadMujD2016 <- sum(D2016$EDADMUJ)
  EdadMujD2017 <- sum(D2017$EDADMUJ)
  EdadMujD2018 <- sum(D2018$EDADMUJ)
  EdadMujD2019 <- sum(D2019$EDADMUJ)
  EdadMujD2020 <- sum(D2020$EDADMUJ)
  EdadMujD2021 <- sum(D2021$EDADMUJ)
```

```{r}
dfD <- data.frame (año  = c("2009", "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017","2018","2019","2020","2021"), matrimonios = c(EdadMujD2009, EdadMujD2010, EdadMujD2011, EdadMujD2012, EdadMujD2013, EdadMujD2014, EdadMujD2015, EdadMujD2016, EdadMujD2017, EdadMujD2018, EdadMujD2019, EdadMujD2020, EdadMujD2021))
print(dfD)
```

```{r}
ggplot(dfD, aes(x=año, y=matrimonios, group = 1)) + 
  geom_point(size = 2, color = "green") + 
  geom_line(color="green") +
  labs(x = "Año", y = "Divorcios", title = "Divorcios")
```

--------------------------------------------------------------------------------

## Histogramas

2009
```{r}
library(dplyr)
library(ggplot2)
barplot(table(D2009$Edadmuj), main = "Edad de la mujer en divorcios 2009", xlab = "Edad", ylab = "Cantidad", col = "steelblue" , border = "pink")
```

2010
```{r}
barplot(table(D2010$edadmuj), main = "Edad de la mujer en divorcios 2010", xlab = "Edad", ylab = "Cantidad", col = "steelblue" , border = "pink")
```

2011
```{r}
barplot(table(D2011$edadmuj), main = "Edad de la mujer en divorcios 2011", xlab = "Edad", ylab = "Cantidad", col = "steelblue" , border = "pink")
```

2012
```{r}
barplot(table(D2012$EDADMUJ), main = "Edad de la mujer en divorcios 2012", xlab = "Edad", ylab = "Cantidad", col = "steelblue" , border = "pink")
```

2013
```{r}
barplot(table(D2013$EDADMUJ), main = "Edad de la mujer en divorcios 2013", xlab = "Edad", ylab = "Cantidad", col = "steelblue" , border = "pink")
```

2014
```{r}
barplot(table(D2014$EDADMUJ), main = "Edad de la mujer en divorcios 2014", xlab = "Edad", ylab = "Cantidad", col = "steelblue" , border = "pink")
```

2015
```{r}
barplot(table(D2015$EDADMUJ), main = "Edad de la mujer en divorcios 2015", xlab = "Edad", ylab = "Cantidad", col = "steelblue" , border = "pink")
```

2016
```{r}
barplot(table(D2016$EDADMUJ), main = "Edad de la mujer en divorcios 2016", xlab = "Edad", ylab = "Cantidad", col = "steelblue" , border = "pink")
```

2017
```{r}
barplot(table(D2017$EDADMUJ), main = "Edad de la mujer en divorcios 2017", xlab = "Edad", ylab = "Cantidad", col = "steelblue" , border = "pink")
```

2018
```{r}
barplot(table(D2018$EDADMUJ), main = "Edad de la mujer en divorcios 2018", xlab = "Edad", ylab = "Cantidad", col = "steelblue" , border = "pink")
```

2019
```{r}
barplot(table(D2019$EDADMUJ), main = "Edad de la mujer en divorcios 2019", xlab = "Edad", ylab = "Cantidad", col = "steelblue" , border = "pink")
```

2020
```{r}
barplot(table(D2020$EDADMUJ), main = "Edad de la mujer en divorcios 2020", xlab = "Edad", ylab = "Cantidad", col = "steelblue" , border = "pink")
```

2021
```{r}
barplot(table(D2021$EDADMUJ), main = "Edad de la mujer en divorcios 2021", xlab = "Edad", ylab = "Cantidad", col = "steelblue" , border = "pink")
```

